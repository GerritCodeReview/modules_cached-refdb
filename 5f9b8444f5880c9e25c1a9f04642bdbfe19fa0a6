{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "b9901657_77a91b74",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/cachedrefdb/CachedRefRepository.java",
        "patchSetId": 2
      },
      "lineNbr": 369,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2022-12-24T07:40:15Z",
      "side": 1,
      "message": "@matthias.sohn@gmail.com, @sasa.zivkov@sap.com are you guys aware of other special chars that could be used to resolver either a commit or file? I have additionally tried `!@#$%\u0026*.|{}` but they are either not allowed (`*`) or recognised as ref name so OK...",
      "range": {
        "startLine": 368,
        "startChar": 4,
        "endLine": 369,
        "endChar": 74
      },
      "revId": "5f9b8444f5880c9e25c1a9f04642bdbfe19fa0a6",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cb989458_a5cd02c1",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/cachedrefdb/CachedRefRepository.java",
        "patchSetId": 2
      },
      "lineNbr": 369,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2022-12-24T09:55:57Z",
      "side": 1,
      "message": "Have you checked the impact of adding more `||` statements here? If the check becomes more and more complex, the advantage of caching *could* be lost.",
      "revId": "5f9b8444f5880c9e25c1a9f04642bdbfe19fa0a6",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "94f9d9f2_cdfda260",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/cachedrefdb/CachedRefRepository.java",
        "patchSetId": 2
      },
      "lineNbr": 369,
      "author": {
        "id": 1004034
      },
      "writtenOn": "2022-12-24T12:22:50Z",
      "side": 1,
      "message": "- you can use Repository#isValidRefName in JGit to validate ref names\n- revision specifications are explained here https://git-scm.com/docs/git-rev-parse#_specifying_revisions",
      "parentUuid": "b9901657_77a91b74",
      "range": {
        "startLine": 368,
        "startChar": 4,
        "endLine": 369,
        "endChar": 74
      },
      "revId": "5f9b8444f5880c9e25c1a9f04642bdbfe19fa0a6",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "da54a114_bb9821fe",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/cachedrefdb/CachedRefRepository.java",
        "patchSetId": 2
      },
      "lineNbr": 369,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2022-12-27T09:05:35Z",
      "side": 1,
      "message": "\u003e - you can use Repository#isValidRefName in JGit to validate ref names\n\nWe should also check the performance of `Repository#isValidRefName` to see if this change would really make a difference or not.\n\n\u003e - revision specifications are explained here https://git-scm.com/docs/git-rev-parse#_specifying_revisions\n\n+1",
      "parentUuid": "94f9d9f2_cdfda260",
      "range": {
        "startLine": 368,
        "startChar": 4,
        "endLine": 369,
        "endChar": 74
      },
      "revId": "5f9b8444f5880c9e25c1a9f04642bdbfe19fa0a6",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a8f54f59_34dc7d9c",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/cachedrefdb/CachedRefRepository.java",
        "patchSetId": 2
      },
      "lineNbr": 369,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2022-12-29T09:28:44Z",
      "side": 1,
      "message": "Thanks for pointers!\n\nThe `isValidRefName` seems to be doing a lot of checks (that will be performed most likely again when it will eventually go to `exactRef`) OTOH  revision spec mentions the following characters: `^~:@` so it seems that we are still missing the `@` in our checks. I will add it and compare it against no check and publish results so that we can judge if it still brings anything ;)",
      "parentUuid": "da54a114_bb9821fe",
      "range": {
        "startLine": 368,
        "startChar": 4,
        "endLine": 369,
        "endChar": 74
      },
      "revId": "5f9b8444f5880c9e25c1a9f04642bdbfe19fa0a6",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4718501a_66721f27",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/cachedrefdb/CachedRefRepository.java",
        "patchSetId": 2
      },
      "lineNbr": 369,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2022-12-29T15:52:12Z",
      "side": 1,
      "message": "I have reworked the check to rely on Guava\u0027s `CharMatcher` that checks all chars in a single ref characters loop. The result is performance tested in [1] (so please review it) TL;DR it is about `~2 ¬µs` overhead per call (which is netto `~78 ¬µs` long) that is not cached. WDYT?\n\n[1] https://gerrit-review.googlesource.com/c/modules/cached-refdb/+/355697",
      "parentUuid": "cb989458_a5cd02c1",
      "revId": "5f9b8444f5880c9e25c1a9f04642bdbfe19fa0a6",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a15d5e3d_cc255bcf",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/cachedrefdb/CachedRefRepository.java",
        "patchSetId": 2
      },
      "lineNbr": 369,
      "author": {
        "id": 1025452
      },
      "writtenOn": "2022-12-29T15:53:16Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "a8f54f59_34dc7d9c",
      "range": {
        "startLine": 368,
        "startChar": 4,
        "endLine": 369,
        "endChar": 74
      },
      "revId": "5f9b8444f5880c9e25c1a9f04642bdbfe19fa0a6",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "dbf253d2_7a8735ff",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/cachedrefdb/CachedRefRepository.java",
        "patchSetId": 2
      },
      "lineNbr": 369,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2022-12-30T12:40:25Z",
      "side": 1,
      "message": "üëç good job !",
      "parentUuid": "4718501a_66721f27",
      "revId": "5f9b8444f5880c9e25c1a9f04642bdbfe19fa0a6",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ]
}